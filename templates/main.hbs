<div class="specificity">
  {{log this}}
  {{!-- <p>
    <button type="button" class="ftc-state-button" data-state="pinned" disabled>
      <i class="fa-solid {{lookup icons.module "pinned"}}"></i>
    </button>
    Pin any modules that you want to stay active throughout the search.<br>
    <button type="button" class="ftc-state-button" data-state="excluded" disabled>
      <i class="fa-solid {{lookup icons.module "excluded"}}"></i>
    </button>
    Exclude any modules you want to disable for the search
  </p>     --}}
  <input type="text" name="search" placeholder="{{localize "FindTheCulprit.SelectMods.FilterModules"}}" value="">
  <ul class="ftc-module-list">
    {{#each modules}}
      <li data-module="{{id}}"{{#if hidden}} class="ftc-hidden"{{/if}}>
        <div class="tooltip-wrapper" data-tooltip="{{> moduleTooltip this~}}" data-tooltip-class="ftc-module-tooltip" data-tooltip-direction="LEFT">
          <button class="ftc-state-button" type="button" id="find-the-culprit-cycle-{{id}}" data-action="cycle" data-state="{{state}}" {{disabled forced}}>
            <i class="fa-solid {{lookup @root.icons.module state}}"></i>
            {{#if forced}}<i class="fa-solid fa-lock corner-icon"></i>{{/if}}
          </button>
        </div>
        <label class="module-title" {{#unless forced}}for="find-the-culprit-cycle-{{id}}"{{/unless}}>
          {{~title~}}
        </label>
      </li>
    {{/each}}
  </ul>
  <div class="button-row">
    <button
      type="button"
      data-action="clearAll"      
      data-tooltip="{{localize 'FindTheCulprit.SelectMods.Action.clearAll.Tooltip'}}"
    >
      <i class="fa-solid fa-arrow-rotate-left"></i>
      <span>{{localize "FindTheCulprit.SelectMods.Action.clearAll.Label"}}</span>
    </button>
    <button
      type="button"
      data-action="lockLibraries"
      data-tooltip="{{localize (concat "FindTheCulprit.SelectMods.Action.lockLibraries.Tooltip." (ifThen lockLibraries.value "Enabled" "Disabled"))}}"
    >
      <i class="fa-solid {{lockLibraries.icon}}"></i>
      <span>{{localize (concat "FindTheCulprit.SelectMods.Action.lockLibraries.Label." (ifThen lockLibraries.value "Enabled" "Disabled"))}}</span>
    </button>
    <button
      type="button"
      data-action="reloadAll"
      data-tooltip="{{localize (concat "FindTheCulprit.SelectMods.Action.reloadAll.Tooltip." (ifThen reloadAll.value "Enabled" "Disabled"))}}"
    >
      <i class="fa-solid {{reloadAll.icon}}"></i>
      <span>{{localize (concat "FindTheCulprit.SelectMods.Action.reloadAll.Label." (ifThen reloadAll.value "Enabled" "Disabled"))}}</span>
    </button>
  </div>
  <p>
    {{{localize "FindTheCulprit.SelectMods.Usage.Usage"}}}
  </p>
  <p>
    {{{localize "FindTheCulprit.SelectMods.Usage.Disclaimer"}}}
  </p>
  <p>
    {{{localize "FindTheCulprit.SelectMods.Usage.Reassurance"}}}
  </p>
  <footer class="form-footer">
    <button type="submit" data-action="start">
      <i class="fa-solid fa-check"></i>
      <span>{{localize "FindTheCulprit.Start"}}</span>
    </button>
    <button type="button" data-action="close">
      <i class="fa-solid fa-xmark"></i>
      <span>{{localize "Cancel"}}</span>
    </button>
  </footer>
</div>

{{~#*inline "moduleTooltip"~}}
  {{localize (concat "FindTheCulprit.StateTooltip." state)}}
  {{~#if forced~}}
  <div>
    {{!-- <br> --}}
    {{~localize "FindTheCulprit.SelectMods.ForcedTooltip.Preamble"~}}
    <ul>
    {{~#if (eq state "pinned")~}}      
      {{~#if pinnedDependants.size}}<li>{{localize "FindTheCulprit.SelectMods.ForcedTooltip.DependencyOf" pinnedDependants=pinnedDependantsFormatted}}</li>{{/if}}
      {{#if isLockedLibrary}}<li>{{localize "FindTheCulprit.SelectMods.ForcedTooltip.LockedLibrary"}}</li>{{/if}}      
    {{~else if (eq state "excluded")~}}
      <li>{{localize "FindTheCulprit.SelectMods.ForcedTooltip.ExcludedDependencies" excludedDependencies=excludedDependenciesFormatted}}</li>
    {{~/if~}} 
    </ul> 
  </div>
  {{~/if~}}
{{~/inline~}}
